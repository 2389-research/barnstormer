<div class="document">
    <div class="document-notice">
        <span class="notice-icon">&#9432;</span>
        Auto-generated from spec data. Edit cards on the Board to update this document.
        <button class="btn btn-sm btn-regen"
                hx-get="/web/specs/{{ spec_id }}/document"
                hx-target="#canvas" hx-swap="innerHTML"
                title="Refresh document from current spec data">
            Regenerate
        </button>
        <button class="btn btn-sm btn-export"
                hx-post="/web/specs/{{ spec_id }}/regenerate"
                hx-target=".regen-status" hx-swap="innerHTML"
                title="Save exports to disk">
            Export to Disk
        </button>
        <span class="regen-status"></span>
    </div>
    <h1>{{ title }}</h1>
    <blockquote>{{ one_liner }}</blockquote>

    <h2>Goal</h2>
    <div class="doc-content">{{ goal_html|safe }}</div>

    {% if let Some( html) = description_html %}
    <h2>Description</h2>
    <div class="doc-content">{{ html|safe }}</div>
    {% endif %}

    {% if let Some( html) = constraints_html %}
    <h2>Constraints</h2>
    <div class="doc-content">{{ html|safe }}</div>
    {% endif %}

    {% if let Some( html) = success_criteria_html %}
    <h2>Success Criteria</h2>
    <div class="doc-content">{{ html|safe }}</div>
    {% endif %}

    {% if let Some( html) = risks_html %}
    <h2>Risks</h2>
    <div class="doc-content">{{ html|safe }}</div>
    {% endif %}

    {% if let Some( html) = notes_html %}
    <h2>Notes</h2>
    <div class="doc-content">{{ html|safe }}</div>
    {% endif %}

    {% if !lanes.is_empty() %}
    <hr>
    {% for lane in lanes %}
    <h2>{{ lane.name }}</h2>
    {% if lane.cards.is_empty() %}
    <p class="muted">No cards in this lane.</p>
    {% else %}
    {% for card in lane.cards %}
    <h3>{{ card.title }} <span class="card-type badge-{{ card.card_type }}">{{ card.card_type }}</span></h3>
    {% if let Some( html) = card.body_html %}
    <div class="doc-content">{{ html|safe }}</div>
    {% endif %}
    <p class="card-meta">by {{ card.created_by }}</p>
    {% endfor %}
    {% endif %}
    {% endfor %}
    {% endif %}
</div>
